# Поддержка G41/G42 (Компенсация радиуса инструмента)

## Что добавлено

В `woodwop_post.py` добавлена поддержка команд компенсации радиуса инструмента:

- **G41** - Компенсация радиуса инструмента слева (Left Cutter Radius Compensation)
- **G41.1** - Динамическая компенсация слева
- **G42** - Компенсация радиуса инструмента справа (Right Cutter Radius Compensation)
- **G42.1** - Динамическая компенсация справа

## Как это работает

1. **Если FreeCAD генерирует G41/G42** в `Path.Commands`, они будут правильно обработаны
2. **Параметр D** (номер корректора) добавляется автоматически:
   - Если в команде есть параметр `D`, используется он
   - Если нет, используется номер инструмента из Tool Controller

## Примеры G-code

### G41 с параметром D
```
G41 D1 X10 Y10
```

### G42 с автоматическим D из инструмента
```
G42 X20 Y20  (D будет добавлен автоматически из номера инструмента)
```

## Клонирование FreeCAD для изучения исходного кода

### Быстрый способ

```bash
cd ~/Documents
./woodwop\ post/clone_freecad.sh
```

Или вручную:

```bash
cd ~/Documents
git clone https://github.com/FreeCAD/FreeCAD.git
cd FreeCAD
```

### Поиск обработки G41/G42 в исходном коде

```bash
cd ~/Documents/FreeCAD
grep -r "G41\|G42" src/Mod/Path/
```

### Полезные файлы

- `src/Mod/Path/Path/Command.py` - Класс Command для G-code команд
- `src/Mod/Path/PathScripts/PathUtils.py` - Утилиты для работы с Path
- `src/Mod/Path/PathScripts/post/` - Все post-processors

## Проверка работы

1. Создайте операцию в FreeCAD Path с включенной компенсацией радиуса инструмента
2. Экспортируйте через WoodWOP post-processor
3. Проверьте сгенерированный `.nc` файл на наличие G41/G42 команд

## Примечания

- **G40** (отмена компенсации) уже поддерживается и добавляется в заголовок
- Компенсация обычно выполняется на стороне FreeCAD при генерации траектории
- G41/G42 в выходном G-code нужны, если станок должен выполнять компенсацию

## Дополнительная информация

См. также:
- `FREECAD_SETUP.md` - Подробная инструкция по настройке FreeCAD
- `CHANGELOG.md` - История изменений

