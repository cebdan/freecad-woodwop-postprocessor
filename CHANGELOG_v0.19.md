# Отчёт о версии v0.19

## Дата: 2025-01-28

## Основные изменения

### Добавлена кнопка "Открыть папку" во всплывающее окно

**Описание:**
Во всплывающем окне после пост-обработки добавлена кнопка "Открыть папку", которая открывает папку с результатами в файловом менеджере операционной системы и автоматически закрывает диалог.

**Проблема:**
После создания файлов пользователю нужно было вручную открывать папку с результатами в файловом менеджере для просмотра созданных файлов.

**Решение:**
1. **Добавлена кнопка "Открыть папку"**:
   - Отображается только если есть созданные файлы
   - Зелёный стиль (#27ae60) для визуального отличия от кнопки "ОК"
   - Минимальная ширина 120px для читаемости

2. **Кроссплатформенное открытие папки**:
   - Используется `QtGui.QDesktopServices.openUrl()` для кроссплатформенности
   - macOS: открывает Finder
   - Windows: открывает Explorer
   - Linux: открывает файловый менеджер по умолчанию (xdg-open)

3. **Автоматическое закрытие диалога**:
   - При нажатии "Открыть папку" диалог автоматически закрывается
   - При нажатии "ОК" диалог также закрывается (как и раньше)

## Технические детали

### Изменённые файлы:
- `src/Mod/CAM/Path/Post/Command.py` - добавлена кнопка и логика открытия папки
- `.pixi/envs/default/Mod/CAM/Path/Post/Command.py` - синхронизация

### Реализация:

```python
# Определение папки из первого созданного файла
output_dir = os.path.dirname(written_files[0])

# Добавление кнопки
open_folder_button = msgBox.addButton("Открыть папку", QtGui.QMessageBox.ButtonRole.ActionRole)

# Обработка нажатия
if msgBox.clickedButton() == open_folder_button:
    folder_url = QUrl.fromLocalFile(output_dir)
    QtGui.QDesktopServices.openUrl(folder_url)
```

### Импорты:
- Добавлен `QUrl` из `PySide.QtCore` для создания URL из локального пути

## Поведение кнопки

### Условия отображения:
- Кнопка отображается только если есть созданные файлы (`written_files` не пуст)
- Папка должна существовать и быть доступной

### При нажатии:
1. Открывается папка с результатами в файловом менеджере
2. Диалог автоматически закрывается
3. В лог записывается информация об открытии папки

### Стилизация:
- Цвет фона: #27ae60 (зелёный)
- Цвет при наведении: #229954
- Цвет при нажатии: #1e8449
- Белый текст, жирный шрифт
- Скруглённые углы (border-radius: 4px)

## Важные замечания

1. **Кроссплатформенность**: Использование `QDesktopServices.openUrl()` обеспечивает корректную работу на всех платформах без необходимости проверки операционной системы.

2. **Обработка ошибок**: Добавлена обработка исключений при открытии папки с логированием предупреждений.

3. **Логирование**: При успешном открытии папки записывается debug-сообщение в лог FreeCAD.

## Тестирование

Проверено:
- ✅ Кнопка отображается при наличии созданных файлов
- ✅ Кнопка не отображается, если файлы не созданы
- ✅ Открытие папки работает на macOS (Finder)
- ✅ Диалог закрывается после нажатия кнопки
- ✅ Стилизация кнопки соответствует дизайну
- ✅ Файлы синхронизированы между `src` и `.pixi/envs/default`

## Следующие шаги

- Тестирование на Windows и Linux для подтверждения кроссплатформенности
- Возможно, добавить иконку к кнопке для лучшей визуализации
- Рассмотреть возможность добавления других полезных действий (например, "Открыть файл")

## Статус версии

**v0.19: Готов к началу отладки**

Эта версия включает все основные функции пост-процессора и готова к началу отладки и тестирования в реальных условиях.

---

**Примечание:** После изменений в `Command.py` необходимо перезагрузить FreeCAD для применения изменений.

